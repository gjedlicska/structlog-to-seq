[pytest]
strict = true
testpaths = test

[tox]
envlist = lint, py{36,37,38}-testenv, coverage-report
isolated_build = True

[tox:.package]
basepython = python3

[gh-actions]
python =
    3.6: py36
    3.7: py37, lint, coverage-report
    3.8: py38


[testenv:lint]
basepython = python3.7
skip_install = true
deps = pre-commit
passenv = HOMEPATH  # needed on Windows
commands = pre-commit run --all-files


[testenv]
deps = coverage[toml]
       pytest
       structlog
       colorful
commands = coverage run -m pytest {posargs}

[testenv:coverage-report]
basepython = python3.7
deps = coverage[toml]
skip_install = true
commands =
    coverage combine
    coverage report


[flake8]
exclude = .tox
show-source = true
enable-extensions=G
application-import-names = structlog_to_seq
max-line-length = 88
extend-ignore = E203
